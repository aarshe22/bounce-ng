RewriteEngine On
RewriteBase /

# Redirect to login if not authenticated (except for login and auth pages)
RewriteCond %{REQUEST_URI} !^/login\.php$
RewriteCond %{REQUEST_URI} !^/auth/
RewriteCond %{REQUEST_URI} !^/api/
RewriteCond %{REQUEST_URI} !^/public/
RewriteCond %{HTTP_COOKIE} !PHPSESSID
RewriteRule ^(.*)$ /login.php [R=302,L]

# Route API requests
RewriteRule ^api/(.*)$ /api/$1 [L]

# Route auth requests
RewriteRule ^auth/(.*)$ /auth/$1 [L]

# Serve index.html for SPA
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ /index.php [L]

